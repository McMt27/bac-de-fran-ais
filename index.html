<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Figures de Style - BAC Fran√ßais</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .menu-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .menu-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .menu-card p {
            color: #7f8c8d;
            margin-bottom: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: scale(1.05);
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .category {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .category h3 {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            color: white;
            text-align: center;
        }

        .analogie { background: #e74c3c; }
        .opposition { background: #f39c12; }
        .insistance { background: #27ae60; }
        .amplification { background: #3498db; }
        .autres { background: #9b59b6; }

        .figure-list {
            list-style: none;
        }

        .figure-list li {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .figure-list li:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .content-area {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .figure-detail {
            display: none;
        }

        .figure-detail.active {
            display: block;
        }

        .example {
            background: #f8f9fa;
            padding: 20px;
            border-left: 4px solid #667eea;
            margin: 20px 0;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }

        .quiz-container {
            margin: 20px 0;
        }

        .question {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .options {
            list-style: none;
            margin: 10px 0;
        }

        .options li {
            padding: 8px 15px;
            margin: 5px 0;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .options li:hover {
            border-color: #667eea;
        }

        .options li.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .options li.correct {
            background: #27ae60;
            border-color: #27ae60;
            color: white;
        }

        .options li.wrong {
            background: #e74c3c;
            border-color: #e74c3c;
            color: white;
        }

        .quiz-controls {
            text-align: center;
            margin: 20px 0;
        }

        .timer {
            font-size: 1.2em;
            font-weight: bold;
            color: #e74c3c;
            margin: 20px 0;
            text-align: center;
        }

        .score {
            text-align: center;
            font-size: 1.5em;
            margin: 20px 0;
            padding: 20px;
            background: #d4edda;
            border-radius: 8px;
            color: #155724;
        }

        .hidden {
            display: none;
        }

        .back-btn {
            background: #6c757d;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .main-menu {
                grid-template-columns: 1fr;
            }
            
            .categories {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Figures de Style</h1>
            <p class="subtitle">R√©vision pour le BAC Fran√ßais</p>
        </header>

        <!-- Menu principal -->
        <div id="home-page">
            <div class="main-menu">
                <div class="menu-card" onclick="showCategories()">
                    <h3>üìñ Fiches par cat√©gories</h3>
                    <p>D√©couvrez toutes les figures de style organis√©es par th√®me</p>
                    <button class="btn">Explorer</button>
                </div>
                
                <div class="menu-card" onclick="startGlobalQuiz()">
                    <h3>üéØ Quiz Global</h3>
                    <p>Testez vos connaissances avec un QCM complet</p>
                    <button class="btn">Commencer</button>
                </div>
                
                <div class="menu-card" onclick="startExercises()">
                    <h3>‚úèÔ∏è Exercices</h3>
                    <p>Entra√Ænez-vous avec des exercices pratiques</p>
                    <button class="btn">S'entra√Æner</button>
                </div>
                
                <div class="menu-card" onclick="randomFigure()">
                    <h3>üé≤ Mode Al√©atoire</h3>
                    <p>Une figure de style tir√©e au hasard</p>
                    <button class="btn">Surprise !</button>
                </div>
            </div>
        </div>

        <!-- Page des cat√©gories -->
        <div id="categories-page" class="hidden">
            <button class="btn back-btn" onclick="showHome()">‚Üê Retour au menu</button>
            <div class="categories">
                <div class="category">
                    <h3 class="analogie">Figures d'analogie</h3>
                    <ul class="figure-list">
                        <li onclick="showFigure('comparaison')">Comparaison</li>
                        <li onclick="showFigure('metaphore')">M√©taphore</li>
                        <li onclick="showFigure('allegorie')">All√©gorie</li>
                        <li onclick="showFigure('personnification')">Personnification</li>
                    </ul>
                </div>
                
                <div class="category">
                    <h3 class="opposition">Figures d'opposition</h3>
                    <ul class="figure-list">
                        <li onclick="showFigure('antithese')">Antith√®se</li>
                        <li onclick="showFigure('oxymore')">Oxymore</li>
                        <li onclick="showFigure('chiasme')">Chiasme</li>
                    </ul>
                </div>
                
                <div class="category">
                    <h3 class="insistance">Figures d'insistance</h3>
                    <ul class="figure-list">
                        <li onclick="showFigure('anaphore')">Anaphore</li>
                        <li onclick="showFigure('repetition')">R√©p√©tition</li>
                        <li onclick="showFigure('pleonasme')">Pl√©onasme</li>
                        <li onclick="showFigure('gradation')">Gradation</li>
                    </ul>
                </div>
                
                <div class="category">
                    <h3 class="amplification">Figures d'amplification</h3>
                    <ul class="figure-list">
                        <li onclick="showFigure('litote')">Litote</li>
                        <li onclick="showFigure('euphemisme')">Euph√©misme</li>
                        <li onclick="showFigure('hyperbole')">Hyperbole</li>
                    </ul>
                </div>
                
                <div class="category">
                    <h3 class="autres">Autres figures</h3>
                    <ul class="figure-list">
                        <li onclick="showFigure('parallelisme')">Parall√©lisme</li>
                        <li onclick="showFigure('enumeration')">√ânum√©ration</li>
                        <li onclick="showFigure('ellipse')">Ellipse</li>
                        <li onclick="showFigure('metonymie')">M√©tonymie</li>
                        <li onclick="showFigure('synecdoque')">Synecdoque</li>
                        <li onclick="showFigure('paradoxe')">Paradoxe</li>
                        <li onclick="showFigure('ironie')">Ironie</li>
                        <li onclick="showFigure('alliteration')">Allit√©ration</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Fiches d√©taill√©es -->
        <div id="figure-detail-page" class="hidden">
            <button class="btn back-btn" onclick="showCategories()">‚Üê Retour aux cat√©gories</button>
            <div class="content-area">
                <div id="figure-content"></div>
            </div>
        </div>

        <!-- Quiz global -->
        <div id="quiz-page" class="hidden">
            <button class="btn back-btn" onclick="showHome()">‚Üê Retour au menu</button>
            <div class="content-area">
                <div class="quiz-controls">
                    <label>Nombre de questions : </label>
                    <select id="quiz-length">
                        <option value="5">5 questions</option>
                        <option value="10" selected>10 questions</option>
                        <option value="15">15 questions</option>
                        <option value="20">20 questions</option>
                    </select>
                    <br><br>
                    <label>
                        <input type="checkbox" id="timer-enabled"> Activer le chronom√®tre
                    </label>
                    <br><br>
                    <button class="btn" onclick="generateQuiz()">Commencer le Quiz</button>
                </div>
                
                <div id="quiz-content" class="hidden">
                    <div class="timer" id="timer"></div>
                    <div id="quiz-questions"></div>
                    <div class="quiz-controls">
                        <button class="btn" onclick="submitQuiz()">Terminer le Quiz</button>
                    </div>
                </div>
                
                <div id="quiz-results" class="hidden"></div>
            </div>
        </div>

        <!-- Exercices -->
        <div id="exercises-page" class="hidden">
            <button class="btn back-btn" onclick="showHome()">‚Üê Retour au menu</button>
            <div class="content-area">
                <h2>Exercices Pratiques</h2>
                <div id="exercise-content">
                    <p>Choisissez un type d'exercice :</p>
                    <button class="btn" onclick="startIdentificationExercise()">Identification dans un texte</button>
                    <button class="btn" onclick="startCompletionExercise()">Compl√©ter des phrases</button>
                    <button class="btn" onclick="startClassificationExercise()">Classification</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Base de donn√©es des figures de style
        const figuresData = {
            comparaison: {
                name: "Comparaison",
                category: "analogie",
                definition: "Rapprochement entre deux √©l√©ments √† l'aide d'un mot de comparaison (comme, tel que, ainsi que, etc.)",
                example: "¬´ La vie est comme un voyage ¬ª - Cette comparaison met en parall√®le la vie et un voyage pour souligner leur caract√®re impr√©visible et √©volutif.",
                quiz: {
                    question: "Quelle phrase contient une comparaison ?",
                    options: [
                        "Il pleut des cordes",
                        "Elle court comme le vent",
                        "Cette femme est un ange",
                        "J'ai une faim de loup"
                    ],
                    correct: 1
                }
            },
            metaphore: {
                name: "M√©taphore",
                category: "analogie",
                definition: "Comparaison implicite sans mot de comparaison, qui assimile un √©l√©ment √† un autre",
                example: "¬´ Il pleure dans mon c≈ìur comme il pleut sur la ville ¬ª (Verlaine) - Le c≈ìur est implicitement compar√© √† un paysage urbain sous la pluie.",
                quiz: {
                    question: "Identifiez la m√©taphore :",
                    options: [
                        "Ses yeux brillent comme des √©toiles",
                        "Ses yeux sont des √©toiles",
                        "Ses yeux ressemblent √† des √©toiles",
                        "Ses yeux scintillent tel des √©toiles"
                    ],
                    correct: 1
                }
            },
            hyperbole: {
                name: "Hyperbole",
                category: "amplification",
                definition: "Exag√©ration volontaire pour cr√©er un effet expressif",
                example: "¬´ Je meurs de faim ! ¬ª - L'exag√©ration souligne l'intensit√© de la sensation de faim.",
                quiz: {
                    question: "Quelle phrase contient une hyperbole ?",
                    options: [
                        "Il fait un peu froid",
                        "Je suis assez fatigu√©",
                        "Je t'aime √† la folie",
                        "Il est plut√¥t grand"
                    ],
                    correct: 2
                }
            },
            antithese: {
                name: "Antith√®se",
                category: "opposition",
                definition: "Opposition de deux id√©es ou de deux expressions contraires dans une m√™me phrase",
                example: "¬´ Je vis, je meurs ; je me br√ªle et me noie ¬ª (Louise Lab√©) - Opposition entre vie/mort, br√ªler/noyer.",
                quiz: {
                    question: "Reconnaissez l'antith√®se :",
                    options: [
                        "Il fait beau aujourd'hui",
                        "Paris, ville de lumi√®re et d'ombre",
                        "Elle chante tr√®s bien",
                        "Le temps passe vite"
                    ],
                    correct: 1
                }
            },
            anaphore: {
                name: "Anaphore",
                category: "insistance",
                definition: "R√©p√©tition d'un mot ou d'un groupe de mots en d√©but de phrase ou de vers",
                example: "¬´ Rome, l'unique objet de mon ressentiment ! Rome √† qui vient ton bras d'immoler mon amant ! ¬ª (Corneille) - R√©p√©tition de 'Rome'.",
                quiz: {
                    question: "Identifiez l'anaphore :",
                    options: [
                        "Il court, il vole, il triomphe",
                        "Que tu viennes, que tu partes, que tu restes",
                        "Heureux qui comme Ulysse...",
                        "Demain, d√®s l'aube, √† l'heure o√π blanchit la campagne"
                    ],
                    correct: 1
                }
            },
            alliteration: {
                name: "Allit√©ration",
                category: "autres",
                definition: "R√©p√©tition de consonnes identiques ou proches dans un vers ou une phrase",
                example: "¬´ Pour qui sont ces serpents qui sifflent sur vos t√™tes ? ¬ª (Racine) - R√©p√©tition du son [s].",
                quiz: {
                    question: "Trouvez l'allit√©ration :",
                    options: [
                        "Le vent souffle fort",
                        "Les sanglots longs des violons",
                        "Il fait tr√®s beau",
                        "La nuit tombe doucement"
                    ],
                    correct: 1
                }
            },
            litote: {
                name: "Litote",
                category: "amplification",
                definition: "Expression qui consiste √† dire moins pour sugg√©rer plus, souvent par la n√©gation du contraire",
                example: "¬´ Va, je ne te hais point ¬ª (Corneille) - Chim√®ne dit √† Rodrigue qu'elle l'aime en niant qu'elle le haisse.",
                quiz: {
                    question: "Quelle phrase contient une litote ?",
                    options: [
                        "Il n'est pas d√©sagr√©able √† regarder",
                        "Il est tr√®s beau",
                        "Il me pla√Æt √©norm√©ment",
                        "Je le trouve charmant"
                    ],
                    correct: 0
                }
            },
            oxymore: {
                name: "Oxymore",
                category: "opposition",
                definition: "Alliance de mots contradictoires pour cr√©er une expression paradoxale",
                example: "¬´ Cette obscure clart√© qui tombe des √©toiles ¬ª (Corneille) - Association d'obscure et clart√©.",
                quiz: {
                    question: "Identifiez l'oxymore :",
                    options: [
                        "Un silence assourdissant",
                        "Une grande maison",
                        "Un beau paysage",
                        "Une route longue"
                    ],
                    correct: 0
                }
            },
            personnification: {
                name: "Personnification",
                category: "analogie",
                definition: "Attribution de caract√®res humains √† des objets, des animaux ou des concepts abstraits",
                example: "¬´ Le vent murmure dans les arbres ¬ª - Le vent est dot√© de la capacit√© humaine de murmurer.",
                quiz: {
                    question: "Trouvez la personnification :",
                    options: [
                        "L'homme court vite",
                        "La rivi√®re chante",
                        "Le chien aboie",
                        "L'oiseau vole"
                    ],
                    correct: 1
                }
            },
            metonymie: {
                name: "M√©tonymie",
                category: "autres",
                definition: "Remplacement d'un mot par un autre entretenant avec lui une relation logique (contenant/contenu, cause/effet, etc.)",
                example: "¬´ Boire un verre ¬ª - Le contenant (verre) d√©signe le contenu (boisson).",
                quiz: {
                    question: "Identifiez la m√©tonymie :",
                    options: [
                        "Il lit Victor Hugo",
                        "Il lit un livre",
                        "Il lit attentivement",
                        "Il lit √† voix haute"
                    ],
                    correct: 0
                }
            },
            euphemisme: {
                name: "Euph√©misme",
                category: "amplification",
                definition: "Expression att√©nu√©e d'une r√©alit√© brutale ou d√©sagr√©able",
                example: "¬´ Il nous a quitt√©s ¬ª pour dire ¬´ Il est mort ¬ª - Att√©nuation de la r√©alit√© de la mort.",
                quiz: {
                    question: "Quelle phrase contient un euph√©misme ?",
                    options: [
                        "Il est mort hier",
                        "Il s'est endormi pour toujours",
                        "Il a √©t√© tu√©",
                        "Il a succomb√© brutalement"
                    ],
                    correct: 1
                }
            },
            allegorie: {
                name: "All√©gorie",
                category: "analogie",
                definition: "Repr√©sentation d'une id√©e abstraite par une image concr√®te d√©velopp√©e",
                example: "La Justice repr√©sent√©e par une femme aux yeux band√©s tenant une balance - L'id√©e abstraite de justice prend forme humaine.",
                quiz: {
                    question: "Reconnaissez l'all√©gorie :",
                    options: [
                        "Il court comme le vent",
                        "La Mort fauche les √¢mes",
                        "Ses yeux brillent",
                        "Il fait chaud"
                    ],
                    correct: 1
                }
            },
            chiasme: {
                name: "Chiasme",
                category: "opposition",
                definition: "Croisement de l'ordre des mots dans deux propositions qui se suivent",
                example: "¬´ Il faut manger pour vivre et non pas vivre pour manger ¬ª (Moli√®re) - Structure ABBA.",
                quiz: {
                    question: "Identifiez le chiasme :",
                    options: [
                        "Il aime la musique et la musique l'aime",
                        "Il chante et danse",
                        "Il court et saute",
                        "Il rit et pleure souvent"
                    ],
                    correct: 0
                }
            },
            repetition: {
                name: "R√©p√©tition",
                category: "insistance",
                definition: "Reprise d'un m√™me mot ou d'une m√™me expression pour insister",
                example: "¬´ Toujours, toujours ! ¬ª - La r√©p√©tition souligne l'aspect permanent et obs√©dant.",
                quiz: {
                    question: "Trouvez la r√©p√©tition :",
                    options: [
                        "Il marche vite",
                        "Non, non et non !",
                        "Il court souvent",
                        "Elle danse bien"
                    ],
                    correct: 1
                }
            },
            pleonasme: {
                name: "Pl√©onasme",
                category: "insistance",
                definition: "R√©p√©tition de mots ayant le m√™me sens pour renforcer l'expression",
                example: "¬´ Monter en haut ¬ª - 'Monter' implique d√©j√† la direction vers le haut.",
                quiz: {
                    question: "Identifiez le pl√©onasme :",
                    options: [
                        "Descendre en bas",
                        "Marcher rapidement",
                        "Courir vite",
                        "Parler fort"
                    ],
                    correct: 0
                }
            },
            gradation: {
                name: "Gradation",
                category: "insistance",
                definition: "Succession de termes d'intensit√© croissante ou d√©croissante",
                example: "¬´ Va, cours, vole et nous venge ! ¬ª (Corneille) - Gradation ascendante de l'urgence.",
                quiz: {
                    question: "Reconnaissez la gradation :",
                    options: [
                        "Il marche, court, vole",
                        "Il mange et boit",
                        "Il rit et pleure",
                        "Il vient et repart"
                    ],
                    correct: 0
                }
            },
            parallelisme: {
                name: "Parall√©lisme",
                category: "autres",
                definition: "R√©p√©tition d'une m√™me structure syntaxique dans des phrases ou propositions successives",
                example: "¬´ Que tu viennes ou que tu partes ¬ª - M√™me structure : que + sujet + verbe.",
                quiz: {
                    question: "Identifiez le parall√©lisme :",
                    options: [
                        "Il mange une pomme",
                        "Quand il rit, quand il pleure",
                        "Il court tr√®s vite",
                        "Elle chante fort"
                    ],
                    correct: 1
                }
            },
            enumeration: {
                name: "√ânum√©ration",
                category: "autres",
                definition: "Suite de mots ou de groupes de mots de m√™me fonction grammaticale",
                example: "¬´ M√©tro, boulot, dodo ¬ª - √ânum√©ration des activit√©s quotidiennes routini√®res.",
                quiz: {
                    question: "Trouvez l'√©num√©ration :",
                    options: [
                        "Livres, cahiers, stylos tra√Ænaient sur la table",
                        "Il lit un livre int√©ressant",
                        "Elle √©crit soigneusement",
                        "Il marche lentement"
                    ],
                    correct: 0
                }
            },
            ellipse: {
                name: "Ellipse",
                category: "autres",
                definition: "Omission volontaire de mots dans une phrase sans nuire √† la compr√©hension",
                example: "¬´ Eux √† droite, nous √† gauche ¬ª - Omission du verbe (sont/allons).",
                quiz: {
                    question: "Identifiez l'ellipse :",
                    options: [
                        "Il mange une pomme rouge",
                        "Lui parti, elle pleura",
                        "Elle court tr√®s rapidement",
                        "Il chante une belle chanson"
                    ],
                    correct: 1
                }
            },
            synecdoque: {
                name: "Synecdoque",
                category: "autres",
                definition: "Remplacement d'un mot par un autre entretenant une relation d'inclusion (partie/tout)",
                example: "¬´ Voile √† l'horizon ! ¬ª - La voile (partie) d√©signe le navire entier.",
                quiz: {
                    question: "Reconnaissez la synecdoque :",
                    options: [
                        "Les mortels (pour les hommes)",
                        "Il boit Victor Hugo",
                        "Il pleut des cordes",
                        "Ses yeux brillent"
                    ],
                    correct: 0
                }
            },
            paradoxe: {
                name: "Paradoxe",
                category: "autres",
                definition: "Affirmation qui semble contradictoire mais qui r√©v√®le une v√©rit√© profonde",
                example: "¬´ Il faut √™tre de son temps et de tous les temps ¬ª - Contradiction apparente qui r√©v√®le une v√©rit√© sur l'universalit√©.",
                quiz: {
                    question: "Identifiez le paradoxe :",
                    options: [
                        "Plus on sait, moins on sait",
                        "Il fait beau aujourd'hui",
                        "Elle chante bien",
                        "Il court vite"
                    ],
                    correct: 0
                }
            },
            ironie: {
                name: "Ironie",
                category: "autres",
                definition: "Expression du contraire de ce qu'on pense, souvent dans un but critique ou humoristique",
                example: "¬´ Bravo ! ¬ª dit √† quelqu'un qui vient de faire une erreur - Le compliment exprime en r√©alit√© une critique.",
                quiz: {
                    question: "Trouvez l'ironie :",
                    options: [
                        "Quel beau temps ! (par temps de pluie)",
                        "Il fait vraiment beau",
                        "Le soleil brille",
                        "J'aime cette journ√©e"
                    ],
                    correct: 0
                }
            }
        };

        // Variables globales
        let currentQuiz = [];
        let currentQuizIndex = 0;
        let quizResults = [];
        let timerInterval;
        let startTime;

        // Navigation
        function showHome() {
            document.getElementById('home-page').classList.remove('hidden');
            document.getElementById('categories-page').classList.add('hidden');
            document.getElementById('figure-detail-page').classList.add('hidden');
            document.getElementById('quiz-page').classList.add('hidden');
            document.getElementById('exercises-page').classList.add('hidden');
        }

        function showCategories() {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('categories-page').classList.remove('hidden');
            document.getElementById('figure-detail-page').classList.add('hidden');
            document.getElementById('quiz-page').classList.add('hidden');
            document.getElementById('exercises-page').classList.add('hidden');
        }

        function showFigure(figureKey) {
            const figure = figuresData[figureKey];
            if (!figure) return;

            document.getElementById('categories-page').classList.add('hidden');
            document.getElementById('figure-detail-page').classList.remove('hidden');

            const content = document.getElementById('figure-content');
            content.innerHTML = `
                <h2>${figure.name}</h2>
                <p><strong>Cat√©gorie :</strong> ${getCategoryName(figure.category)}</p>
                
                <h3>üìñ D√©finition</h3>
                <p>${figure.definition}</p>
                
                <div class="example">
                    <h4>üí° Exemple litt√©raire</h4>
                    <p>${figure.example}</p>
                </div>
                
                <div class="quiz-container">
                    <h3>üéØ Mini Quiz</h3>
                    <div class="question">
                        <p><strong>${figure.quiz.question}</strong></p>
                        <ul class="options" id="mini-quiz-${figureKey}">
                            ${figure.quiz.options.map((option, index) => 
                                `<li onclick="selectAnswer('mini-quiz-${figureKey}', ${index}, ${figure.quiz.correct})">${option}</li>`
                            ).join('')}
                        </ul>
                        <div id="mini-result-${figureKey}" style="margin-top: 10px;"></div>
                    </div>
                </div>
                
                <div class="quiz-container">
                    <h3>‚úèÔ∏è Exercice pratique</h3>
                    <div id="exercise-${figureKey}"></div>
                    <button class="btn" onclick="generateExercise('${figureKey}')">G√©n√©rer un exercice</button>
                </div>
            `;
        }

        function getCategoryName(category) {
            const names = {
                'analogie': 'Figures d\'analogie',
                'opposition': 'Figures d\'opposition',
                'insistance': 'Figures d\'insistance',
                'amplification': 'Figures d\'amplification',
                'autres': 'Autres figures'
            };
            return names[category] || category;
        }

        function selectAnswer(quizId, selectedIndex, correctIndex) {
            const options = document.querySelectorAll(`#${quizId} li`);
            const resultDiv = document.getElementById(quizId.replace('mini-quiz', 'mini-result'));
            
            options.forEach((option, index) => {
                option.classList.remove('selected', 'correct', 'wrong');
                if (index === correctIndex) {
                    option.classList.add('correct');
                } else if (index === selectedIndex) {
                    option.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                resultDiv.innerHTML = '<p style="color: #27ae60; font-weight: bold;">‚úÖ Correct ! Bien jou√© !</p>';
            } else {
                resultDiv.innerHTML = '<p style="color: #e74c3c; font-weight: bold;">‚ùå Incorrect. La bonne r√©ponse est surlign√©e en vert.</p>';
            }
        }

        function generateExercise(figureKey) {
            const exercises = {
                comparaison: {
                    type: 'completion',
                    instruction: 'Compl√©tez cette phrase avec une comparaison appropri√©e :',
                    text: 'Ses cheveux brillaient _______ des rayons de soleil.',
                    answer: 'comme'
                },
                metaphore: {
                    type: 'identification',
                    instruction: 'Dans ce texte, identifiez la m√©taphore :',
                    text: 'La nuit √©tait un manteau noir qui enveloppait la ville endormie.',
                    answer: 'La nuit √©tait un manteau noir'
                },
                hyperbole: {
                    type: 'classification',
                    instruction: 'Classez ces expressions : laquelle est une hyperbole ?',
                    options: ['Je suis un peu fatigu√©', 'Je tombe de sommeil', 'J\'ai sommeil', 'Je dors mal'],
                    answer: 1
                }
            };

            const exercise = exercises[figureKey];
            if (!exercise) {
                document.getElementById(`exercise-${figureKey}`).innerHTML = '<p>Exercice en cours de d√©veloppement...</p>';
                return;
            }

            let html = `<div class="question"><p><strong>${exercise.instruction}</strong></p>`;
            
            if (exercise.type === 'completion') {
                html += `<p>${exercise.text}</p>
                        <input type="text" id="exercise-input-${figureKey}" placeholder="Votre r√©ponse...">
                        <button class="btn" onclick="checkExerciseAnswer('${figureKey}', '${exercise.answer}')">V√©rifier</button>`;
            } else if (exercise.type === 'identification') {
                html += `<p style="font-style: italic;">"${exercise.text}"</p>
                        <input type="text" id="exercise-input-${figureKey}" placeholder="Identifiez la figure...">
                        <button class="btn" onclick="checkExerciseAnswer('${figureKey}', '${exercise.answer}')">V√©rifier</button>`;
            } else if (exercise.type === 'classification') {
                html += `<ul class="options">
                        ${exercise.options.map((option, index) => 
                            `<li onclick="checkExerciseClassification('${figureKey}', ${index}, ${exercise.answer})">${option}</li>`
                        ).join('')}
                        </ul>`;
            }
            
            html += '<div id="exercise-result-' + figureKey + '"></div></div>';
            document.getElementById(`exercise-${figureKey}`).innerHTML = html;
        }

        function checkExerciseAnswer(figureKey, correctAnswer) {
            const input = document.getElementById(`exercise-input-${figureKey}`);
            const result = document.getElementById(`exercise-result-${figureKey}`);
            const userAnswer = input.value.toLowerCase().trim();
            const correct = correctAnswer.toLowerCase().trim();
            
            if (userAnswer.includes(correct) || correct.includes(userAnswer)) {
                result.innerHTML = '<p style="color: #27ae60; font-weight: bold;">‚úÖ Excellente r√©ponse !</p>';
            } else {
                result.innerHTML = `<p style="color: #e74c3c; font-weight: bold;">‚ùå R√©ponse attendue : "${correctAnswer}"</p>`;
            }
        }

        function checkExerciseClassification(figureKey, selectedIndex, correctIndex) {
            const options = document.querySelectorAll(`#exercise-${figureKey} .options li`);
            const result = document.getElementById(`exercise-result-${figureKey}`);
            
            options.forEach((option, index) => {
                if (index === correctIndex) {
                    option.classList.add('correct');
                } else if (index === selectedIndex) {
                    option.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                result.innerHTML = '<p style="color: #27ae60; font-weight: bold;">‚úÖ Parfait !</p>';
            } else {
                result.innerHTML = '<p style="color: #e74c3c; font-weight: bold;">‚ùå La bonne r√©ponse est surlign√©e en vert.</p>';
            }
        }

        // Quiz global
        function startGlobalQuiz() {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('quiz-page').classList.remove('hidden');
            document.getElementById('quiz-content').classList.add('hidden');
            document.getElementById('quiz-results').classList.add('hidden');
        }

        function generateQuiz() {
            const length = parseInt(document.getElementById('quiz-length').value);
            const timerEnabled = document.getElementById('timer-enabled').checked;
            
            // S√©lectionner des questions al√©atoires
            const figureKeys = Object.keys(figuresData);
            currentQuiz = [];
            quizResults = [];
            
            for (let i = 0; i < length; i++) {
                const randomKey = figureKeys[Math.floor(Math.random() * figureKeys.length)];
                const figure = figuresData[randomKey];
                currentQuiz.push({
                    key: randomKey,
                    question: figure.quiz.question,
                    options: [...figure.quiz.options].sort(() => Math.random() - 0.5), // M√©langer les options
                    correctOriginal: figure.quiz.options[figure.quiz.correct],
                    name: figure.name
                });
            }
            
            currentQuizIndex = 0;
            displayQuiz();
            
            document.querySelector('.quiz-controls').classList.add('hidden');
            document.getElementById('quiz-content').classList.remove('hidden');
            
            if (timerEnabled) {
                startTimer();
            } else {
                document.getElementById('timer').classList.add('hidden');
            }
        }

        function displayQuiz() {
            const container = document.getElementById('quiz-questions');
            container.innerHTML = '';
            
            currentQuiz.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h4>Question ${index + 1} : ${question.name}</h4>
                    <p><strong>${question.question}</strong></p>
                    <ul class="options" id="quiz-question-${index}">
                        ${question.options.map((option, optIndex) => 
                            `<li onclick="selectQuizAnswer(${index}, ${optIndex})">${option}</li>`
                        ).join('')}
                    </ul>
                `;
                container.appendChild(questionDiv);
            });
        }

        function selectQuizAnswer(questionIndex, optionIndex) {
            const options = document.querySelectorAll(`#quiz-question-${questionIndex} li`);
            options.forEach(option => option.classList.remove('selected'));
            options[optionIndex].classList.add('selected');
            
            quizResults[questionIndex] = {
                selected: currentQuiz[questionIndex].options[optionIndex],
                correct: currentQuiz[questionIndex].correctOriginal
            };
        }

        function submitQuiz() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            let score = 0;
            currentQuiz.forEach((question, index) => {
                const result = quizResults[index];
                if (result && result.selected === result.correct) {
                    score++;
                }
                
                // Marquer les bonnes/mauvaises r√©ponses
                const options = document.querySelectorAll(`#quiz-question-${index} li`);
                options.forEach(option => {
                    if (option.textContent === result.correct) {
                        option.classList.add('correct');
                    } else if (option.classList.contains('selected')) {
                        option.classList.add('wrong');
                    }
                });
            });
            
            const percentage = Math.round((score / currentQuiz.length) * 100);
            let message = '';
            
            if (percentage >= 80) {
                message = 'üéâ Excellent ! Vous ma√Ætrisez tr√®s bien les figures de style !';
            } else if (percentage >= 60) {
                message = 'üëç Bon travail ! Continuez √† r√©viser pour vous am√©liorer.';
            } else {
                message = 'üìö Il faut encore r√©viser. Reprenez les fiches pour mieux comprendre.';
            }
            
            document.getElementById('quiz-results').innerHTML = `
                <div class="score">
                    <h3>R√©sultats du Quiz</h3>
                    <p>Score : ${score}/${currentQuiz.length} (${percentage}%)</p>
                    <p>${message}</p>
                    <button class="btn" onclick="generateQuiz()">Refaire un quiz</button>
                    <button class="btn back-btn" onclick="showHome()">Retour au menu</button>
                </div>
            `;
            
            document.getElementById('quiz-results').classList.remove('hidden');
            document.querySelector('#quiz-content .quiz-controls').classList.add('hidden');
        }

        function startTimer() {
            startTime = Date.now();
            const timerElement = document.getElementById('timer');
            timerElement.classList.remove('hidden');
            
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                timerElement.textContent = `‚è±Ô∏è Temps √©coul√© : ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // Fonction al√©atoire
        function randomFigure() {
            const figureKeys = Object.keys(figuresData);
            const randomKey = figureKeys[Math.floor(Math.random() * figureKeys.length)];
            showFigure(randomKey);
        }

        // Exercices
        function startExercises() {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('exercises-page').classList.remove('hidden');
        }

        function startIdentificationExercise() {
            const texts = [
                {
                    text: "Le vent murmurait des secrets √† travers les branches. Cette nuit √©tait un manteau de velours noir parsem√© d'√©toiles scintillantes.",
                    figures: ["personnification (le vent murmurait)", "m√©taphore (cette nuit √©tait un manteau)"]
                },
                {
                    text: "Je meurs de faim ! Ce restaurant est bond√© comme une ruche. L'attente me tue litt√©ralement.",
                    figures: ["hyperbole (je meurs de faim)", "comparaison (bond√© comme une ruche)", "hyperbole (me tue litt√©ralement)"]
                }
            ];
            
            const randomText = texts[Math.floor(Math.random() * texts.length)];
            
            document.getElementById('exercise-content').innerHTML = `
                <h3>üîç Identification dans un texte</h3>
                <div class="question">
                    <p><strong>Identifiez les figures de style dans ce texte :</strong></p>
                    <div class="example">
                        <p>"${randomText.text}"</p>
                    </div>
                    <p>R√©ponses attendues :</p>
                    <ul>
                        ${randomText.figures.map(figure => `<li>${figure}</li>`).join('')}
                    </ul>
                    <button class="btn" onclick="startIdentificationExercise()">Nouveau texte</button>
                </div>
            `;
        }

        function startCompletionExercise() {
            const exercises = [
                {
                    text: "Ses yeux brillaient ______ des diamants.",
                    answer: "comme",
                    type: "Comparaison"
                },
                {
                    text: "Il ne pleut que ______ ! (pour exprimer qu'il pleut beaucoup)",
                    answer: "des cordes",
                    type: "Hyperbole"
                },
                {
                    text: "______, ______, ______ ! (r√©p√©tition pour insister sur le refus)",
                    answer: "Non, non, non",
                    type: "R√©p√©tition"
                }
            ];
            
            const randomEx = exercises[Math.floor(Math.random() * exercises.length)];
            
            document.getElementById('exercise-content').innerHTML = `
                <h3>‚úèÔ∏è Compl√©ter des phrases</h3>
                <div class="question">
                    <p><strong>Compl√©tez cette phrase pour cr√©er une ${randomEx.type.toLowerCase()} :</strong></p>
                    <p style="font-size: 1.2em; margin: 20px 0;">"${randomEx.text}"</p>
                    <input type="text" id="completion-input" placeholder="Votre r√©ponse..." style="width: 300px; padding: 10px; margin: 10px;">
                    <br><br>
                    <button class="btn" onclick="checkCompletion('${randomEx.answer}', '${randomEx.type}')">V√©rifier</button>
                    <button class="btn" onclick="startCompletionExercise()">Nouvelle phrase</button>
                    <div id="completion-result" style="margin-top: 15px;"></div>
                </div>
            `;
        }

        function checkCompletion(correctAnswer, figureType) {
            const input = document.getElementById('completion-input');
            const result = document.getElementById('completion-result');
            const userAnswer = input.value.toLowerCase().trim();
            const correct = correctAnswer.toLowerCase().trim();
            
            if (userAnswer.includes(correct) || correct.includes(userAnswer)) {
                result.innerHTML = `<p style="color: #27ae60; font-weight: bold;">‚úÖ Parfait ! Vous avez bien cr√©√© une ${figureType.toLowerCase()} !</p>`;
            } else {
                result.innerHTML = `<p style="color: #e74c3c; font-weight: bold;">‚ùå R√©ponse attendue : "${correctAnswer}" (${figureType})</p>`;
            }
        }

        function startClassificationExercise() {
            const examples = [
                { text: "Ses cheveux d'or", category: "M√©taphore" },
                { text: "Blanc comme neige", category: "Comparaison" },
                { text: "Je meurs de soif", category: "Hyperbole" },
                { text: "Un silence de mort", category: "M√©taphore" },
                { text: "Rapide comme l'√©clair", category: "Comparaison" },
                { text: "Il ne dit jamais non", category: "Litote" },
                { text: "Cette obscure clart√©", category: "Oxymore" }
            ];
            
            const shuffled = examples.sort(() => Math.random() - 0.5).slice(0, 4);
            
            document.getElementById('exercise-content').innerHTML = `
                <h3>üìù Classification</h3>
                <div class="question">
                    <p><strong>Classez ces expressions selon leur figure de style :</strong></p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                        ${shuffled.map((ex, index) => `
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                                <p style="font-weight: bold; margin-bottom: 10px;">"${ex.text}"</p>
                                <p style="color: #667eea; font-size: 0.9em;">${ex.category}</p>
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn" onclick="startClassificationExercise()">Nouveaux exemples</button>
                </div>
            `;
        }
    </script>
</body>
</html>